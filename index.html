<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>尺寸表搜索工具</title>
    <!-- 图标资源 -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#1a237e">
    <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="android-chrome-512x512.png">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        /* 星空背景 */
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #0a0e2a;
            color: #fff;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* 星空效果 */
        #stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            animation: twinkle var(--duration) infinite alternate;
        }
        
        @keyframes twinkle {
            0% { 
                opacity: 0.3; 
                transform: scale(1);
            }
            50% {
                opacity: 0.9;
                transform: scale(1.2);
            }
            100% { 
                opacity: 0.5; 
                transform: scale(1);
            }
        }
        
        /* 飞船样式 */
        .spaceship {
            position: absolute;
            width: 40px;
            height: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ffd166);
            border-radius: 10px 5px 5px 10px;
            top: 30%;
            left: -50px;
            animation: flyAcross 12s linear infinite;
            filter: drop-shadow(0 0 10px rgba(255, 107, 107, 0.7));
            z-index: 1;
        }
        
        .spaceship::before {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: #7befff;
            border-radius: 50%;
            top: 6px;
            right: 5px;
            box-shadow: 0 0 8px #7befff;
            animation: lightBlink 1s infinite alternate;
        }
        
        .spaceship::after {
            content: '';
            position: absolute;
            width: 15px;
            height: 10px;
            background: linear-gradient(90deg, transparent, #ff6b6b);
            border-radius: 0 5px 5px 0;
            top: 5px;
            right: -12px;
        }
        
        .spaceship-wings {
            position: absolute;
            width: 12px;
            height: 6px;
            background: #ffd166;
            top: -6px;
            left: 10px;
            border-radius: 3px 3px 0 0;
        }
        
        .spaceship-wings::before {
            content: '';
            position: absolute;
            width: 12px;
            height: 6px;
            background: #ffd166;
            top: 20px;
            left: 0;
            border-radius: 0 0 3px 3px;
        }
        
        @keyframes flyAcross {
            0% {
                left: -50px;
                top: 30%;
                transform: translateY(0) rotate(0deg);
            }
            25% {
                top: 25%;
                transform: translateY(-10px) rotate(5deg);
            }
            50% {
                top: 35%;
                transform: translateY(10px) rotate(-5deg);
            }
            75% {
                top: 28%;
                transform: translateY(-5px) rotate(3deg);
            }
            100% {
                left: calc(100% + 50px);
                top: 30%;
                transform: translateY(0) rotate(0deg);
            }
        }
        
        /* 左侧插画区域 */
        .illustration-container {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 250px;
            height: 400px;
            z-index: 0;
            opacity: 0.9;
            display: none;
        }
        
        @media (min-width: 1200px) {
            .illustration-container {
                display: block;
            }
        }
        
        /* 宇航员插画 */
        .astronaut {
            position: absolute;
            width: 160px;
            height: 200px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: float 6s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(123, 239, 255, 0.5));
        }
        
        .astronaut-body {
            position: absolute;
            width: 100px;
            height: 120px;
            background: linear-gradient(145deg, #4a5fc1, #2a3a8f);
            border-radius: 45px 45px 35px 35px;
            top: 60px;
            left: 30px;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.4),
                inset 0 -5px 10px rgba(255, 255, 255, 0.1);
        }
        
        .astronaut-helmet {
            position: absolute;
            width: 110px;
            height: 110px;
            background: radial-gradient(circle at 35% 35%, #7befff, #4a5fc1);
            border-radius: 50%;
            top: 20px;
            left: 25px;
            box-shadow: 
                inset 0 0 25px rgba(123, 239, 255, 0.6),
                0 5px 15px rgba(0, 0, 0, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.2);
        }
        
        .astronaut-visor {
            position: absolute;
            width: 70px;
            height: 50px;
            background: linear-gradient(135deg, rgba(123, 239, 255, 0.4), rgba(255, 255, 255, 0.2));
            border-radius: 50%;
            top: 35px;
            left: 20px;
            box-shadow: 
                inset 0 0 15px rgba(123, 239, 255, 0.5),
                0 0 20px rgba(123, 239, 255, 0.3);
            backdrop-filter: blur(5px);
        }
        
        .astronaut-light {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffd166;
            border-radius: 50%;
            top: 45px;
            right: 30px;
            box-shadow: 0 0 10px #ffd166;
            animation: lightBlink 0.8s infinite alternate;
        }
        
        .astronaut-backpack {
            position: absolute;
            width: 50px;
            height: 70px;
            background: linear-gradient(145deg, #3a506b, #2a3a8f);
            border-radius: 20px;
            top: 80px;
            right: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .astronaut-antenna {
            position: absolute;
            width: 3px;
            height: 25px;
            background: linear-gradient(to top, #7befff, #ffd166);
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }
        
        .astronaut-antenna-tip {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffd166;
            border-radius: 50%;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 8px #ffd166;
            animation: lightBlink 1.2s infinite alternate;
        }
        
        /* 漂浮的行星 */
        .planet {
            position: absolute;
            border-radius: 50%;
            box-shadow: 0 0 30px rgba(255, 94, 0, 0.5);
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.2));
        }
        
        .planet1 {
            width: 70px;
            height: 70px;
            background: radial-gradient(circle at 30% 30%, #ffd166, #ff9a00);
            top: 50px;
            right: 30px;
            animation: orbit1 25s linear infinite;
        }
        
        .planet2 {
            width: 45px;
            height: 45px;
            background: radial-gradient(circle at 30% 30%, #00b4d8, #0077b6);
            bottom: 80px;
            left: 10px;
            animation: orbit2 30s linear infinite reverse;
            box-shadow: 0 0 25px rgba(0, 180, 216, 0.5);
        }
        
        .planet3 {
            width: 35px;
            height: 35px;
            background: radial-gradient(circle at 30% 30%, #9d4edd, #560bad);
            top: 120px;
            left: 40px;
            animation: orbit3 35s linear infinite;
            box-shadow: 0 0 20px rgba(157, 78, 221, 0.5);
        }
        
        /* 流星效果 */
        .meteor {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 8px white;
            animation: meteorFall linear infinite;
        }
        
        @keyframes meteorFall {
            0% {
                opacity: 0;
                transform: translate(0, 0);
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translate(100px, 100px);
            }
        }
        
        /* ==================== 日历容器修复 - 添加溢出控制 ==================== */
        .calendar-container {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 320px;
            background: linear-gradient(145deg, rgba(26, 35, 126, 0.95), rgba(40, 53, 147, 0.95));
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(123, 239, 255, 0.3);
            z-index: 0;
            display: none;
            /* 修复溢出问题 - 添加以下属性 */
            min-width: 280px;
            max-width: 90vw;
            overflow: hidden;
            box-sizing: border-box;
        }
        
        @media (min-width: 1200px) {
            .calendar-container {
                display: block;
            }
        }
        
        /* 天气区域样式 */
        .weather-container {
            background: rgba(28, 37, 65, 0.8);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(123, 239, 255, 0.2);
        }
        
        .weather-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(123, 239, 255, 0.2);
        }
        
        .weather-title {
            color: #7befff;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .weather-location {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .weather-location:hover {
            color: #ffd166;
        }
        
        .weather-main {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .weather-temp {
            font-size: 28px;
            font-weight: bold;
            color: #ffd166;
            display: flex;
            align-items: center;
        }
        
        .weather-icon {
            font-size: 36px;
        }
        
        .weather-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 5px;
        }
        
        .weather-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .weather-detail-item {
            text-align: center;
            padding: 5px;
            background: rgba(40, 53, 147, 0.6);
            border-radius: 6px;
        }
        
        .weather-detail-label {
            display: block;
            margin-bottom: 2px;
        }
        
        .weather-detail-value {
            display: block;
            color: #7befff;
            font-weight: 600;
        }
        
        /* 天气刷新按钮 */
        .weather-refresh {
            background: rgba(91, 192, 190, 0.3);
            border: 1px solid rgba(123, 239, 255, 0.3);
            color: #7befff;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .weather-refresh:hover {
            background: rgba(91, 192, 190, 0.5);
            transform: rotate(180deg);
        }
        
        /* 天气API配置区域 */
        .weather-config {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(123, 239, 255, 0.2);
        }
        
        .weather-config-toggle {
            font-size: 11px;
            color: #ffd166;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .weather-config-content {
            margin-top: 8px;
            display: none;
        }
        
        .weather-config-content.show {
            display: block;
        }
        
        .weather-config-input {
            width: 100%;
            padding: 6px 8px;
            background: rgba(40, 53, 147, 0.8);
            border: 1px solid rgba(123, 239, 255, 0.3);
            border-radius: 4px;
            color: white;
            font-size: 11px;
            margin-bottom: 5px;
        }
        
        .weather-config-btn {
            width: 100%;
            padding: 6px;
            background: linear-gradient(45deg, #5bc0be, #3a506b);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-top: 5px;
        }
        
        .calendar-header {
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }
        
        .calendar-header h3 {
            color: #7befff;
            font-size: 22px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-shadow: 0 0 10px rgba(123, 239, 255, 0.5);
        }
        
        .current-date {
            font-size: 36px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }
        
        .date-details {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .lunar-date {
            color: #ffd166;
            font-size: 16px;
            background: rgba(255, 209, 102, 0.1);
            padding: 5px 12px;
            border-radius: 20px;
            border: 1px solid rgba(255, 209, 102, 0.3);
        }
        
        .week-day {
            color: #5bc0be;
            font-size: 16px;
            font-weight: 600;
        }
        
        /* ==================== 日历网格修复 - 防止数字溢出 ==================== */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 20px;
            /* 修复溢出问题 - 添加以下属性 */
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .calendar-day {
            text-align: center;
            padding: 10px;
            font-size: 14px;
            color: #ffd166;
            font-weight: 600;
            background: rgba(40, 53, 147, 0.5);
            border-radius: 10px;
        }
        
        .calendar-date {
            text-align: center;
            padding: 12px 8px;
            font-size: 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(28, 37, 65, 0.5);
            border: 1px solid rgba(123, 239, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            /* 修复溢出问题 - 添加以下属性 */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .calendar-date:hover {
            background: rgba(91, 192, 190, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .calendar-date.today {
            background: linear-gradient(145deg, #5bc0be, #3a506b);
            color: #fff;
            font-weight: bold;
            border-color: #7befff;
            box-shadow: 0 0 15px rgba(91, 192, 190, 0.5);
        }
        
        .calendar-date.weekend {
            color: #ff9a00;
        }
        
        .calendar-date.other-month {
            color: rgba(255, 255, 255, 0.3);
            background: rgba(28, 37, 65, 0.2);
        }
        
        .calendar-footer {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(123, 239, 255, 0.2);
        }
        
        .calendar-footer-item {
            text-align: center;
            padding: 12px;
            background: rgba(28, 37, 65, 0.6);
            border-radius: 12px;
            border: 1px solid rgba(123, 239, 255, 0.1);
        }
        
        .calendar-footer-label {
            display: block;
            font-size: 12px;
            color: #ffd166;
            margin-bottom: 5px;
        }
        
        .calendar-footer-value {
            display: block;
            font-size: 16px;
            color: #fff;
            font-weight: 600;
        }
        
        /* 主要内容区域 */
        .main-content-area {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding-top: 20px;
        }
        
        /* 优化后的滚动公告条样式 - 改回蓝色 */
        .announcement-bar {
            background: linear-gradient(90deg, #1a237e, #283593);
            color: white;
            padding: 8px 30px 8px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            min-height: 40px;
            display: flex;
            align-items: center;
            border: 1px solid rgba(123, 239, 255, 0.2);
            width: 100%;
            font-size: 14px;
        }
        
        .announcement-content {
            flex: 1;
            overflow: hidden;
            position: relative;
            height: 22px;
        }
        
        .announcement-scroll {
            position: absolute;
            width: 100%;
            animation: scrollAnnouncement 20s linear infinite;
            white-space: nowrap;
            font-size: 13px;
        }
        
        @keyframes scrollAnnouncement {
            0% {
                transform: translateX(100%);
            }
            100% {
                transform: translateX(-100%);
            }
        }
        
        .announcement-close {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .announcement-bar.hidden {
            display: none;
        }
        
        /* 搜索区域 */
        .search-container {
            background: rgba(26, 35, 126, 0.9);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            border-left: 5px solid #5bc0be;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(123, 239, 255, 0.2);
            width: 100%;
        }
        
        h1 {
            color: #7befff;
            margin-bottom: 15px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .search-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
        }
        
        .search-input-container {
            flex: 1;
            min-width: 250px;
        }
        
        #searchInput {
            width: 100%;
            padding: 14px 16px;
            background: rgba(28, 37, 65, 0.8);
            border: 1px solid rgba(123, 239, 255, 0.3);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            color: white;
        }
        
        #searchInput:focus {
            outline: none;
            border-color: #5bc0be;
            box-shadow: 0 0 0 3px rgba(91, 192, 190, 0.2);
        }
        
        button {
            padding: 14px 20px;
            background: linear-gradient(45deg, #5bc0be, #3a506b);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            white-space: nowrap;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #7befff, #5bc0be);
        }
        
        .search-type {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .search-type-btn {
            padding: 10px 15px;
            background: rgba(28, 37, 65, 0.8);
            color: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(123, 239, 255, 0.2);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .search-type-btn.active {
            background: linear-gradient(45deg, #5bc0be, #3a506b);
            color: white;
            border-color: #5bc0be;
        }
        
        .results-info {
            margin: 20px 0;
            font-size: 16px;
            padding: 12px 15px;
            background: rgba(28, 37, 65, 0.8);
            border-radius: 8px;
            border-left: 4px solid #5bc0be;
            color: white;
        }
        
        /* 主要内容布局 */
        .main-content {
            display: flex;
            gap: 25px;
            margin-bottom: 25px;
            width: 100%;
        }
        
        /* 视频容器 */
        .video-container {
            background: rgba(26, 35, 126, 0.9);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            width: 35%;
            min-width: 320px;
            text-align: center;
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(123, 239, 255, 0.2);
        }
        
        .video-container h2 {
            margin-top: 0;
            color: #7befff;
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .video-wrapper {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            flex: 1;
            background: #000;
            min-height: 200px;
        }
        
        .video-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
        
        .video-controls {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .video-controls button {
            padding: 8px 14px;
            font-size: 13px;
        }
        
        .playback-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .playback-controls button {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .autoplay-btn {
            background: linear-gradient(45deg, #4caf50, #2e7d32);
        }
        
        .autoplay-btn.active {
            background: linear-gradient(45deg, #4caf50, #2e7d32);
        }
        
        .auto-next-btn {
            background: linear-gradient(45deg, #9d4edd, #560bad);
        }
        
        .auto-next-btn.active {
            background: linear-gradient(45deg, #9d4edd, #560bad);
        }
        
        .video-nav-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .video-nav-controls button {
            padding: 8px 12px;
            font-size: 12px;
            background: linear-gradient(45deg, #5bc0be, #3a506b);
        }
        
        .video-playlist {
            margin-top: 10px;
            background: rgba(28, 37, 65, 0.8);
            padding: 10px;
            border-radius: 8px;
        }
        
        .playlist-items {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .playlist-item {
            padding: 4px 8px;
            background: rgba(40, 53, 147, 0.8);
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            border: 1px solid rgba(123, 239, 255, 0.2);
            color: white;
        }
        
        .playlist-item.active {
            background: linear-gradient(45deg, #5bc0be, #3a506b);
            color: white;
            border-color: #5bc0be;
        }
        
        .playlist-item:hover {
            background: rgba(91, 192, 190, 0.3);
        }
        
        .playlist-item.active:hover {
            background: linear-gradient(45deg, #7befff, #5bc0be);
        }
        
        .video-loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 16px;
            z-index: 10;
        }
        
        .video-error {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            padding: 20px;
            text-align: center;
            z-index: 10;
        }
        
        .video-error button {
            margin-top: 10px;
            background: linear-gradient(45deg, #f44336, #c62828);
        }
        
        .video-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.3);
            z-index: 5;
        }
        
        .video-progress-bar {
            height: 100%;
            background: #5bc0be;
            width: 0%;
            transition: width 0.3s;
        }
        
        /* 搜索结果区域 - 优化图片显示 */
        .results-container {
            background: rgba(26, 35, 126, 0.9);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            flex: 1;
            min-height: 450px;
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(123, 239, 255, 0.2);
            width: 100%;
        }
        
 /* 优化搜索小图 - 电脑端调整为700x300 */
.image-results {
    display: flex;               /* 改为flex布局 */
    flex-direction: column;      /* 垂直排列 */
    gap: 15px;                   /* 卡片间距 */
    margin-top: 20px;
    flex: 1;
    align-items: center;         /* 居中对齐 */
    justify-items: center;
    width: 100%;
}

.image-card {
    border: 1px solid rgba(123, 239, 255, 0.3);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
    background: rgba(28, 37, 65, 0.8);
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    flex-direction: column;
    height: 300px;               /* ← 修改为300px高度 */
    position: relative;
    width: 700px;               /* ← 修改为700px宽度 */
    max-width: 700px;           /* ← 修改为700px最大宽度 */
    margin: 0 auto;              /* ← 添加水平居中 */
}

.image-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(91, 192, 190, 0.3);
    border-color: #5bc0be;
}

/* 修复图片显示问题 - 电脑端大图 */
.image-card .image-wrapper {
    width: 100%;
    height: 250px;               /* ← 修改为250px (300-50) */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    background-color: rgba(28, 37, 65, 0.8);
    border-bottom: 1px solid rgba(123, 239, 255, 0.2);
}

.image-card img {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: contain;         /* ← 保持图片比例 */
    display: block;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    pointer-events: auto;
    touch-action: manipulation;
    outline: none;
    border: none;
    transition: transform 0.3s ease;
    cursor: pointer;
}

.image-card img:hover {
    transform: scale(1.02);
}

.image-info {
    padding: 10px;
    text-align: center;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-height: 50px;            /* ← 固定文字区域高度 */
}

.image-code {
    font-weight: bold;
    font-size: 1rem;
    color: #7befff;
    margin-bottom: 4px;
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
}  
        .status-info {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            padding: 50px 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        /* 目录容器样式 - 只保留两个选项 */
        .directory-container {
            background: rgba(26, 35, 126, 0.9);
            padding: 12px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(123, 239, 255, 0.2);
        }
        
        .directory-container h3 {
            color: #7befff;
            margin-bottom: 10px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .directory-list {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        /* 目录项样式 - 只保留两个选项 */
        .directory-item {
            padding: 12px 16px;
            border: 1px solid rgba(123, 239, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(28, 37, 65, 0.8);
            min-width: 140px;
            color: white;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
        }
        
        .directory-item:hover {
            background-color: rgba(91, 192, 190, 0.3);
            transform: translateY(-3px);
            border-color: #5bc0be;
        }
        
        .directory-item.active {
            background: linear-gradient(45deg, #5bc0be, #3a506b);
            color: white;
            border-color: #5bc0be;
        }
        
        .update-status {
            background: rgba(28, 37, 65, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 14px;
            border-left: 4px solid #5bc0be;
            color: white;
        }
        
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid #5bc0be;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ==================== 重量结果区域 - 调整为电脑端700x300 ==================== */

.weight-results {
    display: flex;               /* 改为flex布局 */
    flex-direction: column;      /* 垂直排列 */
    gap: 15px;                   /* 卡片间距 */
    margin-top: 15px;
    align-items: center;         /* 居中对齐 */
}

.weight-card {
    border: 1px solid rgba(123, 239, 255, 0.3);
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
    background: rgba(28, 37, 65, 0.8);
    width: 700px;               /* ← 宽度700px */
    height: 300px;              /* ← 高度300px */
    display: flex;
    flex-direction: column;
    margin: 0 auto;             /* ← 水平居中 */
}

.weight-header {
    background: linear-gradient(45deg, #4caf50, #2e7d32);
    color: white;
    padding: 12px 15px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 50px;               /* ← 固定头部高度 */
}

.weight-content {
    padding: 15px;
    flex: 1;                    /* ← 填满剩余空间 */
    display: flex;
    flex-direction: column;
}

.weight-specs {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 8px;
    margin-top: 10px;
    flex: 1;                    /* ← 规格区域可伸缩 */
}

.weight-spec-item {
    text-align: center;
    padding: 8px;
    background: rgba(40, 53, 147, 0.8);
    border-radius: 6px;
}

.weight-spec-name {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 4px;
}

.weight-spec-value {
    font-weight: bold;
    color: #7befff;
    font-size: 0.9rem;
}

.copy-all-btn {
    background: linear-gradient(45deg, #5bc0be, #3a506b);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 0.8rem;
    cursor: pointer;
    margin-top: 10px;
    width: 100%;
}
        
        /* 图片模态框 */
        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .image-modal.active {
            display: flex;
            opacity: 1;
        }
        
        .modal-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
            display: flex;
            flex-direction: column;
            background: rgba(26, 35, 126, 0.95);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(123, 239, 255, 0.3);
        }
        
        .modal-image-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            max-height: calc(100vh - 150px);
            overflow: auto;
            background: rgba(28, 37, 65, 0.8);
        }
        
        .modal-image-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            cursor: default;
        }
        
        .modal-info {
            padding: 15px 20px;
            background: rgba(28, 37, 65, 0.8);
            border-top: 1px solid rgba(123, 239, 255, 0.2);
            color: white;
            text-align: center;
        }
        
        .modal-code {
            font-size: 1.2rem;
            font-weight: bold;
            color: #7befff;
            margin: 0;
        }
        
        .modal-description {
            font-size: 0.95rem;
            margin-bottom: 5px;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .modal-date {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
            z-index: 10;
        }
        
        .modal-close:hover {
            background: rgba(91, 192, 190, 0.8);
            transform: scale(1.1);
        }
        
        /* 动画效果 */
        @keyframes float {
            0%, 100% {
                transform: translate(-50%, -50%);
            }
            50% {
                transform: translate(-50%, -55%);
            }
        }
        
        @keyframes lightBlink {
            0%, 100% {
                opacity: 0.5;
                transform: scale(1);
            }
            50% {
                opacity: 1;
                transform: scale(1.3);
            }
        }
        
        @keyframes orbit1 {
            0% {
                transform: rotate(0deg) translateX(80px) rotate(0deg);
            }
            100% {
                transform: rotate(360deg) translateX(80px) rotate(-360deg);
            }
        }
        
        @keyframes orbit2 {
            0% {
                transform: rotate(0deg) translateX(100px) rotate(0deg);
            }
            100% {
                transform: rotate(360deg) translateX(100px) rotate(-360deg);
            }
        }
        
        @keyframes orbit3 {
            0% {
                transform: rotate(0deg) translateX(60px) rotate(0deg);
            }
            100% {
                transform: rotate(360deg) translateX(60px) rotate(-360deg);
            }
        }
        
/* ==================== 移动端适配 (768px以下) ==================== */
@media (max-width: 768px) {
    body {
        padding: 15px;
    }
    
    .main-content-area {
        width: 100%;
        max-width: 100%;
    }
    
    /* 移动端公告栏 */
    .announcement-bar {
        padding: 6px 25px 6px 12px;
        min-height: 36px;
        font-size: 12px;
        margin-bottom: 12px;
    }
    
    .announcement-content {
        height: 18px;
    }
    
    .announcement-scroll {
        font-size: 11px;
    }
    
    .announcement-close {
        width: 20px;
        height: 20px;
        font-size: 14px;
    }
    
    .search-container {
        padding: 15px;
        margin-top: 10px;
    }
    
    h1 {
        font-size: 1.5rem;
    }
    
    .search-controls {
        flex-direction: column;
    }
    
    .search-input-container {
        min-width: 100%;
    }
    
    button {
        width: 100%;
        margin: 5px 0;
    }
    
    /* 移动端隐藏视频播放器 */
    .video-container {
        display: none !important;
    }
    
    .main-content {
        flex-direction: column;
    }
    
    .results-container {
        min-height: auto;
        width: 100%;
        scroll-margin-top: 80px;
        padding: 15px;
    }
    
    /* 移动端图片显示 */
    .image-results {
        display: flex !important;
        flex-direction: column !important;
        gap: 12px;
        justify-items: center;
        padding: 0 10px;
    }
    
    .image-card {
        width: 100% !important;
        max-width: 100% !important;
        height: 220px !important;
        margin: 0 auto 15px !important;
    }
    
    .image-card .image-wrapper {
        height: 180px !important;
    }
    
    .image-info {
        min-height: 40px !important;
        padding: 8px !important;
    }
    
    /* ========== 移动端重量搜索显示修改 ========== */
    .weight-results {
        display: flex !important;           /* 改为flex布局 */
        flex-direction: column !important;   /* 垂直排列 */
        gap: 12px !important;                /* 卡片间距 */
        padding: 0 10px !important;         /* 左右内边距 */
    }
    
    .weight-card {
        width: 100% !important;             /* 满宽显示 */
        max-width: 100% !important;
        height: 220px !important;           /* 移动端高度 */
        margin: 0 auto 12px !important;     /* 底部间距 */
        border-radius: 8px !important;      /* 圆角 */
    }
    
    .weight-header {
        height: 45px !important;            /* 固定头部高度 */
        padding: 10px 12px !important;      /* 内边距 */
        font-size: 14px !important;
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
    }
    
    .weight-header span {
        font-size: 16px !important;         /* 产品代码字体大小 */
        font-weight: bold !important;
    }
    
    .weight-header button {
        padding: 6px 10px !important;       /* 按钮内边距 */
        font-size: 12px !important;         /* 按钮字体大小 */
        white-space: nowrap !important;     /* 按钮文字不换行 */
    }
    
    .weight-content {
        padding: 12px !important;
        display: flex !important;
        flex-direction: column !important;
    }
    
    .weight-specs {
        display: grid !important;
        grid-template-columns: repeat(3, 1fr) !important; /* 固定3列 */
        gap: 6px !important;                /* 间距 */
        margin-top: 5px !important;
    }
    
    .weight-spec-item {
        padding: 6px !important;
        text-align: center !important;
        border-radius: 4px !important;
    }
    
    .weight-spec-name {
        font-size: 11px !important;         /* 规格名称字体 */
        margin-bottom: 2px !important;
    }
    
    .weight-spec-value {
        font-size: 12px !important;         /* 重量值字体 */
        font-weight: bold !important;
    }
    
    .copy-all-btn {
        padding: 8px !important;
        font-size: 13px !important;
        margin-top: 12px !important;
        border-radius: 4px !important;
    }
    
    /* 完整重量信息区域 */
    .weight-content > div[style*="background: rgba"] {
        margin-top: 8px !important;
        padding: 6px !important;
        font-size: 11px !important;
        border-radius: 4px !important;
    }
    
    /* 移动端目录 */
    .directory-container {
        padding: 10px;
    }
    
    .directory-container h3 {
        font-size: 14px;
    }
    
    .directory-list {
        flex-direction: column;
    }
    
    .directory-item {
        min-width: auto;
        padding: 10px;
        font-size: 13px;
        text-align: center;
    }
    
    /* ==================== 移动端日历适配 ==================== */
    /* 隐藏桌面端日历（在移动端显示另一个版本） */
    .calendar-container {
        display: none !important;
    }
}

/* ==================== 平板端适配 (768px-1024px) ==================== */
@media (max-width: 1024px) and (min-width: 769px) {
    body {
        padding: 20px;
    }
    
    .main-content-area {
        width: 100%;
        max-width: 100%;
    }
    
    /* 平板端公告栏 */
    .announcement-bar {
        padding: 8px 28px 8px 15px;
        min-height: 38px;
        font-size: 13px;
        margin-bottom: 15px;
    }
    
    .announcement-content {
        height: 20px;
    }
    
    .announcement-scroll {
        font-size: 12px;
    }
    
    .search-container {
        padding: 18px;
        margin-top: 15px;
    }
    
    h1 {
        font-size: 1.6rem;
    }
    
    .search-controls {
        flex-direction: row;
        flex-wrap: wrap;
    }
    
    .search-input-container {
        min-width: 60%;
    }
    
    button {
        width: auto;
        margin: 0;
    }
    
    /* ========== 平板端视频播放器优化（不隐藏）========== */
    .video-container {
        display: flex !important;
        width: 100% !important;
        min-width: 100% !important;
        margin-bottom: 20px;
        padding: 15px;
    }
    
    .main-content {
        flex-direction: column;
    }
    
    .results-container {
        min-height: auto;
        width: 100%;
        scroll-margin-top: 80px;
        padding: 18px;
    }
    
    /* 平板端调整视频布局 */
    .video-wrapper {
        min-height: 250px;
        height: 300px;
    }
    
    .video-controls {
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .video-controls button {
        padding: 8px 12px;
        font-size: 12px;
        flex: 1;
        min-width: 120px;
    }
    
    .playback-controls {
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .playback-controls button {
        padding: 6px 10px;
        font-size: 11px;
        flex: 1;
        min-width: 140px;
    }
    
    .video-nav-controls {
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .video-nav-controls button {
        padding: 6px 10px;
        font-size: 11px;
        flex: 1;
        min-width: 120px;
    }
    
    .playlist-items {
        flex-wrap: wrap;
        gap: 6px;
    }
    
    .playlist-item {
        padding: 4px 8px;
        font-size: 10px;
        flex: 1;
        min-width: 60px;
        text-align: center;
    }
    
    /* ========== 平板端图片显示优化 ========== */
    .image-results {
        display: flex !important;
        flex-direction: column !important;
        gap: 15px;
        justify-items: center;
        padding: 0;
        width: 100%;
    }
    
    .image-card {
        width: 100% !important;
        max-width: 600px !important;
        height: 280px !important;
        margin: 0 auto 15px !important;
    }
    
    .image-card .image-wrapper {
        height: 230px !important;
    }
    
    .image-info {
        min-height: 50px !important;
        padding: 10px !important;
    }
    
    .image-code {
        font-size: 1.1rem;
    }
    
    /* ========== 平板端重量搜索显示优化 ========== */
    .weight-results {
        display: flex !important;
        flex-direction: column !important;
        gap: 15px !important;
        padding: 0 !important;
        width: 100%;
    }
    
    .weight-card {
        width: 100% !important;
        max-width: 600px !important;
        height: 280px !important;
        margin: 0 auto 15px !important;
        border-radius: 10px !important;
    }
    
    .weight-header {
        height: 50px !important;
        padding: 12px 15px !important;
        font-size: 15px !important;
    }
    
    .weight-header span {
        font-size: 17px !important;
        font-weight: bold !important;
    }
    
    .weight-header button {
        padding: 7px 12px !important;
        font-size: 13px !important;
    }
    
    .weight-content {
        padding: 15px !important;
        display: flex !important;
        flex-direction: column !important;
    }
    
    .weight-specs {
        display: grid !important;
        grid-template-columns: repeat(4, 1fr) !important;
        gap: 8px !important;
        margin-top: 8px !important;
    }
    
    .weight-spec-item {
        padding: 8px !important;
        text-align: center !important;
        border-radius: 6px !important;
    }
    
    .weight-spec-name {
        font-size: 12px !important;
        margin-bottom: 3px !important;
    }
    
    .weight-spec-value {
        font-size: 13px !important;
        font-weight: bold !important;
    }
    
    .copy-all-btn {
        padding: 9px !important;
        font-size: 14px !important;
        margin-top: 12px !important;
        border-radius: 6px !important;
    }
    
    /* 平板端目录 */
    .directory-container {
        padding: 12px;
    }
    
    .directory-container h3 {
        font-size: 15px;
    }
    
    .directory-list {
        flex-direction: row;
        flex-wrap: wrap;
    }
    
    .directory-item {
        min-width: 120px;
        padding: 12px;
        font-size: 14px;
        text-align: center;
    }
    
    /* ========== 平板端日历优化 ========== */
    .calendar-container {
        display: none !important; /* 平板端隐藏日历，给视频和搜索结果更多空间 */
    }
}

/* ==================== 大平板端适配 (900px-1024px) - 两列布局 ==================== */
@media (max-width: 1024px) and (min-width: 900px) {
    /* 在大平板上显示两列布局 */
    .main-content {
        flex-direction: row !important;
        gap: 20px;
    }
    
    .video-container {
        width: 45% !important;
        min-width: 45% !important;
    }
    
    .results-container {
        width: 55% !important;
        flex: 1;
    }
    
    /* 调整视频高度 */
    .video-wrapper {
        height: 250px;
    }
}

/* ==================== 小平板端适配 (768px-899px) ==================== */
@media (max-width: 899px) and (min-width: 769px) {
    /* 在小平板上保持单列布局，但调整视频大小 */
    .video-wrapper {
        height: 280px;
    }
}

/* ==================== 超小屏幕手机适配 (480px以下) ==================== */
@media (max-width: 480px) {
    body {
        padding: 12px;
    }
    
    .image-results {
        grid-template-columns: 1fr;
        gap: 10px;
        padding: 0 5px;
    }
    
    .image-card {
        height: 200px !important;
        margin: 0 auto 12px !important;
    }
    
    .image-card .image-wrapper {
        height: 160px !important;
    }
    
    .image-info {
        min-height: 35px !important;
        padding: 6px !important;
    }
    
    .image-code {
        font-size: 0.9rem;
    }
    
    /* ========== 超小屏幕重量搜索优化 ========== */
    .weight-card {
        height: 200px !important;
        margin: 0 auto 10px !important;
        border-radius: 6px !important;
    }
    
    .weight-header {
        height: 40px !important;
        padding: 8px 10px !important;
    }
    
    .weight-header span {
        font-size: 15px !important;
    }
    
    .weight-header button {
        padding: 5px 8px !important;
        font-size: 11px !important;
    }
    
    .weight-content {
        padding: 10px !important;
    }
    
    .weight-specs {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 5px !important;
        margin-top: 5px !important;
    }
    
    .weight-spec-item {
        padding: 5px !important;
        border-radius: 4px !important;
    }
    
    .weight-spec-name {
        font-size: 10px !important;
        margin-bottom: 2px !important;
    }
    
    .weight-spec-value {
        font-size: 11px !important;
    }
    
    .copy-all-btn {
        padding: 7px !important;
        font-size: 12px !important;
        margin-top: 10px !important;
        border-radius: 4px !important;
    }
    
    /* 搜索区域超小屏幕优化 */
    .search-container {
        padding: 12px;
    }
    
    h1 {
        font-size: 1.3rem;
    }
    
    .search-type-btn {
        padding: 8px 12px;
        font-size: 13px;
    }
    
    .search-controls {
        gap: 8px;
    }
    
    #searchInput {
        padding: 12px;
        font-size: 14px;
    }
    
    button {
        padding: 12px;
        font-size: 14px;
    }
    
    /* 目录超小屏幕优化 */
    .directory-list {
        flex-direction: column;
        gap: 8px;
    }
    
    .directory-item {
        padding: 8px;
        font-size: 12px;
        min-width: auto;
    }
}
        
        /* 天气通知动画 */
        @keyframes weatherNotificationSlideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes weatherNotificationSlideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* 复制通知动画 */
        @keyframes copyNotificationSlideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes copyNotificationSlideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* 操作指南样式 */
        .context-instruction {
            margin-top: 20px;
            padding: 15px;
            background: rgba(28, 37, 65, 0.8);
            border-radius: 10px;
            border-left: 4px solid #ffd166;
            color: white;
            font-size: 14px;
            text-align: center;
        }

        .context-instruction-modal {
            margin: 15px 0;
            padding: 12px;
            background: rgba(40, 53, 147, 0.6);
            border-radius: 8px;
            border-left: 4px solid #ffd166;
            color: white;
            font-size: 13px;
        }

        /* 复制通知样式 */
        .copy-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10000;
            font-weight: 600;
            border: 1px solid rgba(123, 239, 255, 0.3);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* 移除图片按钮样式 */
        .image-actions {
            display: none;
        }
    </style>
</head>
<body>
    <!-- 星空背景 -->
    <div id="stars"></div>
    
    <!-- 飞船 -->
    <div class="spaceship">
        <div class="spaceship-wings"></div>
    </div>
    
    <!-- 左侧宇航员插画 -->
    <div class="illustration-container">
        <div class="astronaut">
            <div class="astronaut-antenna">
                <div class="astronaut-antenna-tip"></div>
            </div>
            <div class="astronaut-helmet">
                <div class="astronaut-visor"></div>
                <div class="astronaut-light"></div>
            </div>
            <div class="astronaut-body"></div>
            <div class="astronaut-backpack"></div>
        </div>
        <div class="planet planet1"></div>
        <div class="planet planet2"></div>
        <div class="planet planet3"></div>
    </div>
    
    <!-- 右侧日历区域 -->
    <div class="calendar-container">
        <!-- 天气区域 -->
        <div class="weather-container" id="weatherContainer">
            <div class="weather-header">
                <div class="weather-title">🌤️ 当地天气</div>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div class="weather-location" id="weatherLocation">加载中...</div>
                    <div class="weather-refresh" id="weatherRefreshBtn" title="刷新天气">↻</div>
                </div>
            </div>
            <div class="weather-main">
                <div class="weather-temp" id="weatherTemp">--°C</div>
                <div class="weather-icon" id="weatherIcon">⏳</div>
            </div>
            <div class="weather-description" id="weatherDescription">正在获取天气数据...</div>
            <div class="weather-details">
                <div class="weather-detail-item">
                    <span class="weather-detail-label">湿度</span>
                    <span class="weather-detail-value" id="weatherHumidity">--%</span>
                </div>
                <div class="weather-detail-item">
                    <span class="weather-detail-label">风速</span>
                    <span class="weather-detail-value" id="weatherWind">--m/s</span>
                </div>
                <div class="weather-detail-item">
                    <span class="weather-detail-label">体感</span>
                    <span class="weather-detail-value" id="weatherFeelsLike">--°C</span>
                </div>
            </div>
            
            <!-- 天气配置区域 -->
            <div class="weather-config">
                <div class="weather-config-toggle" onclick="toggleWeatherConfig()">
                    ⚙️ 配置天气API
                </div>
                <div class="weather-config-content" id="weatherConfigContent">
                    <input type="text" class="weather-config-input" id="weatherApiKey" 
                           placeholder="输入天气API密钥 (可选)">
                    <input type="text" class="weather-config-input" id="weatherCity" 
                           placeholder="城市名 (如: 东莞)" value="东莞">
                    <button class="weather-config-btn" onclick="saveWeatherConfig()">保存配置</button>
                </div>
            </div>
        </div>
        
        <div class="calendar-header">
            <h3>📅 智能日历</h3>
            <div class="current-date" id="currentDate">--月--日</div>
            <div class="date-details">
                <div class="lunar-date" id="lunarDate">农历--月--</div>
                <div class="week-day" id="weekDay">星期--</div>
            </div>
        </div>
        
        <div class="calendar-grid" id="calendarDays">
            <!-- 星期标题 -->
            <div class="calendar-day">日</div>
            <div class="calendar-day">一</div>
            <div class="calendar-day">二</div>
            <div class="calendar-day">三</div>
            <div class="calendar-day">四</div>
            <div class="calendar-day">五</div>
            <div class="calendar-day">六</div>
            <!-- 日历日期将通过JavaScript动态生成 -->
        </div>
        
        <div class="calendar-footer">
            <div class="calendar-footer-item">
                <span class="calendar-footer-label">节气</span>
                <span class="calendar-footer-value" id="solarTerm">--</span>
            </div>
            <div class="calendar-footer-item">
                <span class="calendar-footer-label">宜</span>
                <span class="calendar-footer-value" id="yiContent">--</span>
            </div>
            <div class="calendar-footer-item">
                <span class="calendar-footer-label">忌</span>
                <span class="calendar-footer-value" id="jiContent">--</span>
            </div>
        </div>
    </div>
    
    <!-- 滚动公告条 -->
    <div class="announcement-bar info" id="announcementBar">
        <div class="announcement-content">
            <div class="announcement-scroll" id="announcementScroll">
                <!-- 公告内容将通过JavaScript动态生成 -->
            </div>
        </div>
        <button class="announcement-close" onclick="closeAnnouncement()">×</button>
    </div>

    <!-- 图片模态框 -->
    <div class="image-modal" id="imageModal">
        <button class="modal-close" onclick="closeModal()">×</button>
        <div class="modal-content">
            <div class="modal-image-container">
                <img id="modalImage" src="" alt="">
            </div>
            <div class="modal-info">
                <div class="modal-code" id="modalCode"></div>
            </div>
        </div>
    </div>

    <!-- 主要内容区域 -->
    <div class="main-content-area">
        <div class="search-container">
            <h1>👕📊 尺寸表搜索工具</h1>
            
            <div class="update-status" id="updateStatus">
                <span class="loading-spinner"></span>
                正在初始化系统...
            </div>
            
            <div class="search-type">
                <button class="search-type-btn active" id="imageSearchBtn" onclick="setSearchType('image')">👚 尺寸表搜索</button>
                <button class="search-type-btn" id="weightSearchBtn" onclick="setSearchType('weight')">⚖️ 重量搜索</button>
            </div>
            
            <div class="search-controls">
                <div class="search-input-container">
                    <input type="text" id="searchInput" placeholder="输入图片代码、描述或标签进行搜索...">
                </div>
                <button onclick="search()">🔍 搜索</button>
                <button class="refresh-btn" onclick="checkUpdate()">🔄 检查更新</button>
            </div>
            
            <div class="results-info" id="resultsInfo"></div>
        </div>

        <div class="directory-container" id="directoryContainer" style="display: none;">
            <h3>📁 选择数据目录</h3>
            <div class="directory-list" id="directoryList">
                <!-- 目录项将通过JavaScript动态生成 -->
            </div>
        </div>

        <div class="main-content">
            <!-- 视频播放区域 -->
            <div class="video-container">
                <h2>🎬 视频教程</h2>
                <div class="video-wrapper">
                    <div class="video-loading" id="videoLoading" style="display: none;">
                        <div>视频加载中...</div>
                    </div>
                    <div class="video-error" id="videoError" style="display: none;">
                        <div>视频加载失败</div>
                        <button onclick="retryVideo()">重试</button>
                    </div>
                    <div class="video-progress">
                        <div class="video-progress-bar" id="videoProgressBar"></div>
                    </div>
                    <iframe class="bilibili-player" 
                            id="bilibiliPlayer"
                            src=""
                            scrolling="no" 
                            border="0" 
                            frameborder="no" 
                            framespacing="0" 
                            allowfullscreen="true"
                            allow="encrypted-media; autoplay">
                    </iframe>
                </div>
                
                <!-- 播放控制区域 -->
                <div class="playback-controls">
                    <button class="autoplay-btn active" id="autoplayBtn" onclick="toggleAutoplay()">⏯️ 自动播放: 开启</button>
                    <button class="auto-next-btn active" id="autoNextBtn" onclick="toggleAutoNext()">⏭️ 自动下一个: 开启</button>
                </div>
                
                <!-- 上一个/下一个控制 -->
                <div class="video-nav-controls">
                    <button onclick="playPreviousVideo()">⏪ 上一个</button>
                    <button onclick="playNextVideo()">⏩ 下一个</button>
                </div>
                
                <!-- 播放列表 -->
                <div class="video-playlist">
                    <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7); margin-bottom: 8px;">播放列表:</div>
                    <div class="playlist-items" id="playlistItems">
                        <!-- 播放列表项将通过JavaScript动态生成 -->
                    </div>
                </div>
                
                <!-- 视频控制按钮 -->
                <div class="video-controls">
                    <button onclick="reloadBilibiliVideo()" style="background: linear-gradient(45deg, #f44336, #c62828);">🔄 重新加载</button>
                    <button onclick="openInNewTab()" style="background: linear-gradient(45deg, #9d4edd, #560bad);">🔗 在新窗口打开</button>
                    <button onclick="forcePlay()" style="background: linear-gradient(45deg, #4caf50, #2e7d32);">▶️ 强制播放</button>
                </div>
                
                <!-- 自定义视频源区域 -->
                <div style="margin-top: 15px; padding: 10px; background: rgba(28, 37, 65, 0.8); border-radius: 8px;">
                    <h4 style="margin-bottom: 10px; color: #7befff;">🎥 自定义视频源</h4>
                    <input type="text" id="customVideoUrl" style="width: 100%; padding: 8px; background: rgba(40, 53, 147, 0.8); border: 1px solid rgba(123, 239, 255, 0.3); border-radius: 4px; margin-bottom: 8px; color: white;" 
                           placeholder="输入视频URL (例如: http://api.qemao.com/api/douyin)" 
                           value="http://api.qemao.com/api/douyin">
                    <button onclick="loadCustomVideo()" style="width: 100%; padding: 8px; background: linear-gradient(45deg, #9d4edd, #560bad);">加载自定义视频</button>
                </div>
                
                <div style="margin-top: 15px; font-size: 12px; color: rgba(255, 255, 255, 0.7);">
                    <p>💡 提示：视频可能需要网络连接，部分视频可能受区域限制</p>
                </div>
            </div>

            <!-- 搜索结果区域 -->
            <div class="results-container" id="results">
                <div class="status-info">
                    <p>📥 正在加载数据，请稍候...</p>
                    <p>系统初始化完成后，您可以搜索图片或重量信息</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 配置数据源目录 - 只保留两个，去掉描述
        const DATA_DIRECTORIES = [
            {
                name: "本地数据文件",
                url: "./images.json"
            },
            {
                name: "CDN备份",
                url: "https://cdn.jsdelivr.net/gh/iptv369/image-database@main/images.json"
            }
        ];

        // 重量数据源配置
        const WEIGHT_DATA_SOURCES = [
            {
                name: "本地重量数据",
                url: "./weight.js",
                description: "主要重量数据源 - 使用同目录下的weight.js文件",
                type: "traditional"
            }
        ];

        // 示例数据
        const SAMPLE_DATA = [
            {
                code: "17A3",
                description: "示例图片1 - 产品尺寸图",
                date: "2023-10-01",
                url: "https://picsum.photos/id/1/300/200"
            },
            {
                code: "9002",
                description: "示例图片2 - 安装示意图",
                date: "2023-10-02",
                url: "https://picsum.photos/id/20/300/200"
            },
            {
                code: "A011",
                description: "示例图片3 - 使用说明图",
                date: "2023-10-03",
                url: "https://picsum.photos/id/30/300/200"
            }
        ];

        // 默认重量数据
        let weightData = {
            "17A3": {
                "S": "220g",
                "M": "240g", 
                "L": "260g",
                "XL": "280g"
            },
            "9002": {
                "TU": "118g"
            },
            "A011": {
                "M": "240g",
                "L": "260g", 
                "XL": "280g"
            }
        };

        // 播放列表配置
        const VIDEO_PLAYLIST = [
            {
                id: 'BV1N9yFBpEaf',
                title: '操作教程',
                type: 'bilibili',
                duration: 120
            },
            {
                id: 'BV1qBCCBtEQ2',
                title: '广东视频',
                type: 'bilibili',
                duration: 180
            },
            {
                id: 'BV1n5CYBNEy5', 
                title: '蜡笔小新视频',
                type: 'bilibili',
                duration: 240
            },
            {
                id: 'https://api.qemao.com/api/douyin',
                title: '抖音视频源',
                type: 'direct',
                duration: 300
            }
        ];

        // 天气配置
        const WEATHER_CONFIG = {
            apiKey: "",
            city: "Dongguan",
            countryCode: "CN",
            units: "metric",
            fallbackApi: "https://api.open-meteo.com/v1/forecast"
        };

        let imageData = [];
        let currentSearchType = 'image';
        let currentDataSource = null;
        let currentWeatherCity = "东莞";
        let weatherApiKey = "";
        let weatherUpdateTimer = null;

        // 视频播放控制状态
        let autoplayEnabled = true;
        let autoNextEnabled = true;
        let userInteracted = false;
        let currentPlaylistIndex = 0;
        let videoProgressInterval = null;
        let currentVideoStartTime = 0;

        // ==================== 简单准确的农历计算 ====================
        function getAccurateLunarDate(year, month, day) {
            // 2025年准确的农历数据表
            const lunarData2025 = {
                // 1月
                '2025-01-01': '甲辰年腊月初二',
                '2025-01-29': '甲辰年腊月三十', // 除夕
                '2025-01-30': '乙巳年正月初一', // 春节
                
                // 2月
                '2025-02-10': '乙巳年正月十二',
                '2025-02-20': '乙巳年正月廿二',
                '2025-02-28': '乙巳年正月三十',
                
                // 3月
                '2025-03-01': '乙巳年二月初二',
                '2025-03-10': '乙巳年二月十一',
                '2025-03-20': '乙巳年二月廿一',
                '2025-03-30': '乙巳年三月初一',
                
                // 4月
                '2025-04-01': '乙巳年三月初三',
                '2025-04-10': '乙巳年三月十二',
                '2025-04-20': '乙巳年三月廿二',
                '2025-04-30': '乙巳年四月初三',
                
                // 5月
                '2025-05-01': '乙巳年四月初四',
                '2025-05-10': '乙巳年四月十三',
                '2025-05-20': '乙巳年四月廿三',
                '2025-05-30': '乙巳年五月初三',
                
                // 6月
                '2025-06-01': '乙巳年五月初五',
                '2025-06-10': '乙巳年五月十四',
                '2025-06-20': '乙巳年五月廿四',
                '2025-06-30': '乙巳年闰五月初四', // 2025年有闰六月
                
                // 7月
                '2025-07-01': '乙巳年闰五月初五',
                '2025-07-10': '乙巳年闰五月十四',
                '2025-07-20': '乙巳年闰五月廿四',
                '2025-07-30': '乙巳年六月初五',
                
                // 8月
                '2025-08-01': '乙巳年六月初七',
                '2025-08-10': '乙巳年六月十六',
                '2025-08-20': '乙巳年六月廿六',
                '2025-08-30': '乙巳年七月初七',
                
                // 9月
                '2025-09-01': '乙巳年七月初九',
                '2025-09-10': '乙巳年七月十八',
                '2025-09-20': '乙巳年七月廿八',
                '2025-09-30': '乙巳年八月初八',
                
                // 10月
                '2025-10-01': '乙巳年八月初九',
                '2025-10-10': '乙巳年八月十八',
                '2025-10-20': '乙巳年八月廿八',
                '2025-10-30': '乙巳年九月初九',
                
                // 11月
                '2025-11-01': '乙巳年九月十一',
                '2025-11-10': '乙巳年九月二十',
                '2025-11-20': '乙巳年九月三十',
                '2025-11-30': '乙巳年十月初十',
                
                // 12月
                '2025-12-01': '乙巳年十月十一',
                '2025-12-10': '乙巳年十月二十',
                '2025-12-20': '乙巳年十月三十',
                '2025-12-25': '乙巳年冬月初五', // 圣诞节
                '2025-12-30': '乙巳年冬月初十',
                '2025-12-31': '乙巳年冬月十一'
            };

            const dateStr = `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
            
            // 如果有精确匹配，直接返回
            if (lunarData2025[dateStr]) {
                return lunarData2025[dateStr];
            }
            
            // 如果没有精确匹配，查找最近的数据进行计算
            const dateObj = new Date(year, month - 1, day);
            
            // 2025年春节是1月29日
            const springFestival2025 = new Date(2025, 0, 29);
            const diffDays = Math.floor((dateObj - springFestival2025) / (1000 * 60 * 60 * 24));
            
            if (diffDays >= 0) {
                // 春节之后，属于乙巳年
                const lunarMonthNames = ["正月", "二月", "三月", "四月", "五月", "六月", 
                                       "七月", "八月", "九月", "十月", "冬月", "腊月"];
                const lunarDayNames = ["初一", "初二", "初三", "初四", "初五", "初六", "初七", "初八", "初九", "初十",
                                     "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十",
                                     "廿一", "廿二", "廿三", "廿四", "廿五", "廿六", "廿七", "廿八", "廿九", "三十"];
                
                // 2025年农历月份天数（包括闰六月）
                const lunarMonthDays = [
                    30, 29, 30, 29, 30, 29, 30, 29, 30, 29,  // 正月至五月
                    30,  // 闰六月（2025年有闰六月）
                    30, 29, 30, 29, 30, 29, 30, 29, 30, 29  // 六月至腊月
                ];
                
                let remainingDays = diffDays;
                let lunarMonth = 0;
                
                // 计算农历月份
                while (remainingDays >= lunarMonthDays[lunarMonth]) {
                    remainingDays -= lunarMonthDays[lunarMonth];
                    lunarMonth++;
                }
                
                const lunarDay = remainingDays + 1;
                
                // 处理闰月显示
                let monthDisplay = "";
                if (lunarMonth === 5) { // 第六个月是闰六月
                    monthDisplay = "闰六月";
                } else if (lunarMonth > 5) {
                    monthDisplay = lunarMonthNames[lunarMonth - 1]; // 闰月后的月份减1
                } else {
                    monthDisplay = lunarMonthNames[lunarMonth];
                }
                
                return `乙巳年${monthDisplay}${lunarDayNames[lunarDay - 1]}`;
            } else {
                // 春节之前，属于甲辰年
                return "甲辰年腊月";
            }
        }

        // 获取节气（简化版）
        function getSolarTerm(year, month, day) {
            const solarTerms = ["小寒", "大寒", "立春", "雨水", "惊蛰", "春分", "清明", "谷雨", 
                              "立夏", "小满", "芒种", "夏至", "小暑", "大暑", "立秋", "处暑", 
                              "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至"];
            
            const date = new Date(year, month - 1, day);
            const startOfYear = new Date(year, 0, 1);
            const dayOfYear = Math.floor((date - startOfYear) / (1000 * 60 * 60 * 24)) + 1;
            
            // 节气近似计算（每15天一个节气）
            const termIndex = Math.floor((dayOfYear - 1) / 15) % 24;
            return solarTerms[termIndex] || "--";
        }

        // 获取宜忌（简化版）
        function getYiJi(year, month, day) {
            const yiItems = ["祭祀", "祈福", "求嗣", "开光", "出行", "解除", "交易", "立券", "纳财", "安床"];
            const jiItems = ["嫁娶", "安葬", "破土", "开市", "入宅", "动土", "作灶", "栽种"];
            
            // 基于日期的简单计算
            const dateNum = year * 10000 + month * 100 + day;
            const yiIndex = dateNum % yiItems.length;
            const jiIndex = dateNum % jiItems.length;
            
            return {
                yi: yiItems[yiIndex] || "祭祀",
                ji: jiItems[jiIndex] || "破土"
            };
        }

        // ==================== 初始化函数 ====================
        async function initialize() {
            // 创建星空背景
            createStars();
            createMeteors();
            
            // 初始化日历
            initializeCalendar();
            
            // 加载天气配置并初始化天气
            loadWeatherConfig();
            await initializeRealWeather();
            
            updateStatus('正在加载数据...', 'default');
            
            // 加载公告
            await loadAnnouncements();
            
            // 加载重量数据
            await loadWeightData();
            
            // 显示目录选择器
            await showDirectorySelector();
            
            // 立即尝试加载本地数据文件
            loadFromDirectory(0);
            
            // 初始化视频播放器
            initializeVideoPlayer();
            
            // 设置天气刷新按钮事件
            document.getElementById('weatherRefreshBtn').addEventListener('click', function() {
                refreshWeather();
            });
        }

        // 创建星空背景
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 200;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                
                const duration = Math.random() * 1.5 + 0.5;
                star.style.setProperty('--duration', duration + 's');
                
                star.style.opacity = Math.random() * 0.8 + 0.2;
                
                starsContainer.appendChild(star);
            }
        }

        // 创建流星效果
        function createMeteors() {
            const starsContainer = document.getElementById('stars');
            const meteorCount = 5;
            
            for (let i = 0; i < meteorCount; i++) {
                const meteor = document.createElement('div');
                meteor.className = 'meteor';
                
                meteor.style.left = Math.random() * 30 + '%';
                meteor.style.top = Math.random() * 30 + '%';
                
                const duration = Math.random() * 2 + 1;
                const delay = Math.random() * 10;
                
                meteor.style.animationDuration = duration + 's';
                meteor.style.animationDelay = delay + 's';
                
                starsContainer.appendChild(meteor);
            }
        }

        // 初始化日历
        function initializeCalendar() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const date = now.getDate();
            const day = now.getDay();
            
            const weekDays = ["日", "一", "二", "三", "四", "五", "六"];
            
            document.getElementById('currentDate').textContent = `${month + 1}月${date}日`;
            document.getElementById('weekDay').textContent = `星期${weekDays[day]}`;
            
            // 使用准确的农历计算
            const lunarDate = getAccurateLunarDate(year, month + 1, date);
            document.getElementById('lunarDate').textContent = `农历${lunarDate}`;
            
            // 获取节气
            const solarTerm = getSolarTerm(year, month + 1, date);
            document.getElementById('solarTerm').textContent = solarTerm;
            
            // 获取宜忌
            const { yi, ji } = getYiJi(year, month + 1, date);
            document.getElementById('yiContent').textContent = yi;
            document.getElementById('jiContent').textContent = ji;
            
            // 生成日历
            generateCalendar(year, month);
        }

        // 生成日历
        function generateCalendar(year, month) {
            const calendarGrid = document.getElementById('calendarDays');
            
            // 清空现有日期（保留星期标题）
            while (calendarGrid.children.length > 7) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }
            
            // 获取当月第一天
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            
            // 第一天是星期几
            const firstDayIndex = firstDay.getDay();
            
            // 添加上个月的最后几天
            const prevMonthLastDay = new Date(year, month, 0).getDate();
            for (let i = firstDayIndex - 1; i >= 0; i--) {
                const day = prevMonthLastDay - i;
                const dateElement = document.createElement('div');
                dateElement.className = 'calendar-date other-month';
                dateElement.textContent = day;
                calendarGrid.appendChild(dateElement);
            }
            
            // 添加当月日期
            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const dateElement = document.createElement('div');
                dateElement.className = 'calendar-date';
                dateElement.textContent = day;
                
                // 检查是否是今天
                if (year === today.getFullYear() && 
                    month === today.getMonth() && 
                    day === today.getDate()) {
                    dateElement.classList.add('today');
                }
                
                // 检查是否是周末
                const dayIndex = (firstDayIndex + day - 1) % 7;
                if (dayIndex === 0 || dayIndex === 6) {
                    dateElement.classList.add('weekend');
                }
                
                calendarGrid.appendChild(dateElement);
            }
            
            // 添加下个月的开始几天
            const totalCells = 42; // 6行 * 7天
            const remainingCells = totalCells - (firstDayIndex + daysInMonth);
            for (let day = 1; day <= remainingCells; day++) {
                const dateElement = document.createElement('div');
                dateElement.className = 'calendar-date other-month';
                dateElement.textContent = day;
                calendarGrid.appendChild(dateElement);
            }
        }

        // 加载天气配置
        function loadWeatherConfig() {
            try {
                const savedConfig = localStorage.getItem('weatherConfig');
                if (savedConfig) {
                    const config = JSON.parse(savedConfig);
                    weatherApiKey = config.apiKey || "";
                    currentWeatherCity = config.city || "东莞";
                    
                    // 更新输入框
                    document.getElementById('weatherApiKey').value = weatherApiKey;
                    document.getElementById('weatherCity').value = currentWeatherCity;
                }
            } catch (e) {
                console.log('天气配置加载失败，使用默认设置');
            }
        }

        // 保存天气配置
        function saveWeatherConfig() {
            const apiKey = document.getElementById('weatherApiKey').value.trim();
            const city = document.getElementById('weatherCity').value.trim() || "东莞";
            
            weatherApiKey = apiKey;
            currentWeatherCity = city;
            
            const config = {
                apiKey: apiKey,
                city: city
            };
            
            try {
                localStorage.setItem('weatherConfig', JSON.stringify(config));
                showCopyNotification('✅ 天气配置已保存');
                
                // 隐藏配置区域
                document.getElementById('weatherConfigContent').classList.remove('show');
                
                // 刷新天气
                refreshWeather();
            } catch (e) {
                showCopyNotification('⚠️ 配置保存失败: ' + e.message);
            }
        }

        // 切换天气配置显示
        function toggleWeatherConfig() {
            const configContent = document.getElementById('weatherConfigContent');
            configContent.classList.toggle('show');
        }

        // 初始化真实天气
        async function initializeRealWeather() {
            // 先显示加载状态
            document.getElementById('weatherLocation').textContent = currentWeatherCity;
            document.getElementById('weatherTemp').textContent = '--°C';
            document.getElementById('weatherIcon').textContent = '⏳';
            document.getElementById('weatherDescription').textContent = '正在获取天气数据...';
            document.getElementById('weatherHumidity').textContent = '--%';
            document.getElementById('weatherWind').textContent = '--m/s';
            document.getElementById('weatherFeelsLike').textContent = '--°C';
            
            // 获取天气数据
            await fetchRealWeather();
            
            // 设置定时刷新（每30分钟刷新一次）
            if (weatherUpdateTimer) {
                clearInterval(weatherUpdateTimer);
            }
            weatherUpdateTimer = setInterval(fetchRealWeather, 30 * 60 * 1000);
        }

        // 获取真实天气数据
        async function fetchRealWeather() {
            try {
                let weatherData;
                
                // 如果有用户提供的API密钥，使用和风天气API
                if (weatherApiKey) {
                    weatherData = await fetchHeWeatherData();
                } else {
                    // 否则使用免费API
                    weatherData = await fetchFreeWeatherData();
                }
                
                // 更新显示
                updateWeatherDisplayWithRealData(weatherData);
                
            } catch (error) {
                console.error('天气数据获取失败:', error);
                
                // 显示错误信息
                document.getElementById('weatherDescription').textContent = '天气数据获取失败';
                document.getElementById('weatherIcon').textContent = '⚠️';
                
                // 显示通知
                showCopyNotification('⚠️ 天气数据获取失败，请检查网络或配置');
            }
        }

        // 获取和风天气数据
        async function fetchHeWeatherData() {
            if (!weatherApiKey) {
                throw new Error('未配置API密钥');
            }
            
            const encodedCity = encodeURIComponent(currentWeatherCity);
            const url = `https://devapi.qweather.com/v7/weather/now?location=${encodedCity}&key=${weatherApiKey}`;
            
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`API请求失败: ${response.status}`);
            }
            
            const data = await response.json();
            
            if (data.code !== '200') {
                throw new Error(`API错误: ${data.code}`);
            }
            
            return {
                temperature: data.now.temp,
                condition: data.now.text,
                humidity: data.now.humidity,
                windSpeed: data.now.windSpeed,
                feelsLike: data.now.feelsLike,
                icon: getWeatherIconFromCode(data.now.icon)
            };
        }

        // 获取免费天气数据
        async function fetchFreeWeatherData() {
            const geocodingUrl = `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(currentWeatherCity)}&count=1&language=zh&format=json`;
            
            const geoResponse = await fetch(geocodingUrl);
            if (!geoResponse.ok) {
                throw new Error('地理位置查询失败');
            }
            
            const geoData = await geoResponse.json();
            
            if (!geoData.results || geoData.results.length === 0) {
                throw new Error('未找到城市信息');
            }
            
            const location = geoData.results[0];
            const latitude = location.latitude;
            const longitude = location.longitude;
            const cityName = location.name;
            
            currentWeatherCity = cityName;
            
            const weatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&hourly=temperature_2m,relativehumidity_2m,windspeed_10m&timezone=auto`;
            
            const weatherResponse = await fetch(weatherUrl);
            if (!weatherResponse.ok) {
                throw new Error('天气数据获取失败');
            }
            
            const weatherData = await weatherResponse.json();
            
            const current = weatherData.current_weather;
            const hourly = weatherData.hourly;
            
            const currentTime = new Date(current.time);
            let tempIndex = -1;
            
            for (let i = 0; i < hourly.time.length; i++) {
                const hourTime = new Date(hourly.time[i]);
                if (hourTime.getHours() === currentTime.getHours()) {
                    tempIndex = i;
                    break;
                }
            }
            
            const humidity = tempIndex >= 0 ? hourly.relativehumidity_2m[tempIndex] : 50;
            const windSpeed = current.windspeed;
            const temperature = current.temperature;
            const feelsLike = calculateRealFeelsLike(temperature, humidity, windSpeed);
            const weatherCode = current.weathercode;
            const { condition, icon } = getWeatherFromCode(weatherCode);
            
            return {
                temperature: temperature,
                condition: condition,
                humidity: humidity,
                windSpeed: windSpeed,
                feelsLike: feelsLike,
                icon: icon
            };
        }

        // 根据天气代码获取天气信息
        function getWeatherFromCode(code) {
            const weatherMap = {
                0: { condition: "晴", icon: "☀️" },
                1: { condition: "主要晴朗", icon: "🌤️" },
                2: { condition: "局部多云", icon: "⛅" },
                3: { condition: "多云", icon: "☁️" },
                45: { condition: "雾", icon: "🌫️" },
                48: { condition: "雾", icon: "🌫️" },
                51: { condition: "毛毛雨", icon: "🌦️" },
                53: { condition: "毛毛雨", icon: "🌦️" },
                55: { condition: "毛毛雨", icon: "🌦️" },
                56: { condition: "冻毛毛雨", icon: "🌨️" },
                57: { condition: "冻毛毛雨", icon: "🌨️" },
                61: { condition: "小雨", icon: "🌧️" },
                63: { condition: "中雨", icon: "🌧️" },
                65: { condition: "大雨", icon: "🌧️" },
                66: { condition: "冻雨", icon: "🌨️" },
                67: { condition: "冻雨", icon: "🌨️" },
                71: { condition: "小雪", icon: "🌨️" },
                73: { condition: "中雪", icon: "❄️" },
                75: { condition: "大雪", icon: "❄️" },
                77: { condition: "雪粒", icon: "❄️" },
                80: { condition: "阵雨", icon: "🌦️" },
                81: { condition: "阵雨", icon: "🌦️" },
                82: { condition: "强阵雨", icon: "⛈️" },
                85: { condition: "阵雪", icon: "🌨️" },
                86: { condition: "阵雪", icon: "🌨️" },
                95: { condition: "雷暴", icon: "⛈️" },
                96: { condition: "雷暴", icon: "⛈️" },
                99: { condition: "雷暴", icon: "⛈️" }
            };
            
            return weatherMap[code] || { condition: "未知", icon: "🌤️" };
        }

        // 计算真实体感温度
        function calculateRealFeelsLike(temp, humidity, windSpeed) {
            let feelsLike = temp;
            
            if (temp >= 25) {
                feelsLike += (humidity - 50) * 0.05;
            }
            
            if (temp < 10 && windSpeed > 5) {
                const windChill = 13.12 + 0.6215 * temp - 11.37 * Math.pow(windSpeed, 0.16) + 0.3965 * temp * Math.pow(windSpeed, 0.16);
                feelsLike = Math.min(feelsLike, windChill);
            }
            
            return Math.round(feelsLike * 10) / 10;
        }

        // 从和风天气图标代码获取图标
        function getWeatherIconFromCode(iconCode) {
            const iconMap = {
                "100": "☀️", "101": "🌤️", "102": "⛅", "103": "☁️", "104": "☁️",
                "150": "🌙", "151": "☁️", "152": "☁️", "153": "☁️",
                "300": "🌧️", "301": "🌧️", "302": "⛈️", "303": "⛈️", "304": "🌧️",
                "305": "🌦️", "306": "🌧️", "307": "🌧️", "308": "🌧️", "309": "🌧️",
                "310": "🌧️", "311": "🌧️", "312": "🌧️", "313": "🌧️", "314": "🌧️",
                "315": "🌧️", "316": "🌧️", "317": "🌧️", "318": "🌧️", "399": "🌧️",
                "400": "🌨️", "401": "❄️", "402": "❄️", "403": "❄️", "404": "🌨️",
                "405": "🌨️", "406": "🌨️", "407": "🌨️", "408": "❄️", "409": "❄️",
                "410": "❄️", "499": "🌨️", "500": "🌫️", "501": "🌫️", "502": "🌫️",
                "503": "😷", "504": "😷", "507": "😷", "508": "😷", "509": "🌫️",
                "510": "🌫️", "511": "🌫️", "512": "😷", "513": "😷", "514": "🌫️",
                "515": "🌫️"
            };
            
            return iconMap[iconCode] || "🌤️";
        }

        // 使用真实天气数据更新显示
        function updateWeatherDisplayWithRealData(weatherData) {
            document.getElementById('weatherLocation').textContent = currentWeatherCity;
            document.getElementById('weatherTemp').textContent = `${Math.round(weatherData.temperature)}°C`;
            document.getElementById('weatherIcon').textContent = weatherData.icon;
            document.getElementById('weatherDescription').textContent = weatherData.condition;
            document.getElementById('weatherHumidity').textContent = `${Math.round(weatherData.humidity)}%`;
            document.getElementById('weatherWind').textContent = `${Math.round(weatherData.windSpeed * 10) / 10} m/s`;
            document.getElementById('weatherFeelsLike').textContent = `${Math.round(weatherData.feelsLike)}°C`;
            
            const now = new Date();
            const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            document.getElementById('weatherDescription').textContent += ` (${timeString}更新)`;
        }

        // 刷新天气
        function refreshWeather() {
            showCopyNotification('🔄 正在刷新天气数据...');
            fetchRealWeather();
        }

        // 显示复制通知
        function showCopyNotification(message) {
            // 移除旧的通知
            const oldNotification = document.querySelector('.copy-notification');
            if (oldNotification) {
                oldNotification.remove();
            }
            
            const notification = document.createElement('div');
            notification.className = 'copy-notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // 3秒后自动移除
            setTimeout(() => {
                if (notification.parentNode) {
                    document.body.removeChild(notification);
                }
            }, 3000);
        }

        // 加载重量数据
        async function loadWeightData() {
            updateStatus('正在加载重量数据...', 'default');
            
            let loaded = false;
            
            for (const source of WEIGHT_DATA_SOURCES) {
                try {
                    if (source.type === "traditional") {
                        await loadWeightDataFromTraditional(source.url);
                        loaded = true;
                        updateStatus(`✅ 已从 ${source.name} 加载重量数据`, 'success');
                        break;
                    }
                } catch (error) {
                    console.log(`${source.name} 加载失败:`, error.message);
                    continue;
                }
            }
            
            if (!loaded) {
                updateStatus('⚠️ 重量数据加载失败，使用默认数据', 'warning');
            }
        }

        // 从传统JS文件加载重量数据
        function loadWeightDataFromTraditional(url) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = url + '?t=' + Date.now();
                script.onload = () => {
                    setTimeout(() => {
                        if (typeof window.weightData !== 'undefined') {
                            weightData = window.weightData;
                            console.log('重量数据加载成功:', Object.keys(weightData).length + '个款式');
                            resolve();
                        } else {
                            reject(new Error('JS文件未定义weightData变量'));
                        }
                    }, 100);
                };
                script.onerror = () => reject(new Error('JS文件加载失败'));
                document.head.appendChild(script);
            });
        }

        // 加载公告
        async function loadAnnouncements() {
            try {
                // 优先尝试从根目录读取公告文件
                const announcementFiles = [
                    './announcements.txt',
                    './announcement.txt', 
                    './notice.txt',
                    './notices.txt',
                    './公告.txt',
                    './公告.md'
                ];
                
                let announcements = [];
                let fileFound = false;
                
                // 依次尝试各个可能的公告文件
                for (const file of announcementFiles) {
                    try {
                        const response = await fetch(file + '?t=' + Date.now());
                        if (response.ok) {
                            const content = await response.text();
                            if (content.trim()) {
                                // 解析公告内容
                                announcements = parseAnnouncementContent(content);
                                fileFound = true;
                                console.log(`✅ 成功加载公告文件: ${file}`);
                                break;
                            }
                        }
                    } catch (error) {
                        console.log(`尝试加载 ${file} 失败:`, error.message);
                        continue;
                    }
                }
                
                // 如果没有找到公告文件，使用默认公告
                if (!fileFound || announcements.length === 0) {
                    announcements = [
                        { message: "🎉 欢迎使用尺寸表搜索工具！系统已全面优化", type: "info" },
                        { message: "🌤️ 新增真实天气功能，支持实时天气数据", type: "success" },
                        { message: "⚡ 优化了图片显示效果，图片显示更简洁", type: "info" },
                        { message: "📅 新增2025年准确农历计算功能", type: "success" },
                        { message: "📢 提示：在根目录创建 announcements.txt 文件可自定义公告", type: "warning" }
                    ];
                    console.log('使用默认公告');
                }
                
                displayAnnouncements(announcements);
                
            } catch (error) {
                console.log('公告加载失败:', error.message);
                // 使用默认公告作为后备
                const defaultAnnouncements = [
                    { message: "🎉 欢迎使用尺寸表搜索工具！系统已全面优化", type: "info" },
                    { message: "📢 公告加载失败，请检查公告文件", type: "warning" }
                ];
                displayAnnouncements(defaultAnnouncements);
            }
        }

        // 解析公告内容
        function parseAnnouncementContent(content) {
            const announcements = [];
            const lines = content.split('\n');
            
            for (const line of lines) {
                const trimmedLine = line.trim();
                if (!trimmedLine) continue; // 跳过空行
                
                // 解析格式：[类型] 公告内容
                let type = "info";
                let message = trimmedLine;
                
                if (trimmedLine.startsWith('[INFO]') || trimmedLine.startsWith('[info]')) {
                    type = "info";
                    message = trimmedLine.substring(6).trim();
                } else if (trimmedLine.startsWith('[SUCCESS]') || trimmedLine.startsWith('[success]')) {
                    type = "success";
                    message = trimmedLine.substring(9).trim();
                } else if (trimmedLine.startsWith('[WARNING]') || trimmedLine.startsWith('[warning]')) {
                    type = "warning";
                    message = trimmedLine.substring(9).trim();
                } else if (trimmedLine.startsWith('[ERROR]') || trimmedLine.startsWith('[error]')) {
                    type = "error";
                    message = trimmedLine.substring(7).trim();
                } else if (trimmedLine.startsWith('[更新]')) {
                    type = "success";
                    message = trimmedLine.substring(4).trim();
                } else if (trimmedLine.startsWith('[重要]')) {
                    type = "warning";
                    message = trimmedLine.substring(4).trim();
                }
                
                // 移除可能的前缀符号
                message = message.replace(/^[•\-*>]\s*/, '');
                
                if (message) {
                    announcements.push({
                        message: message,
                        type: type
                    });
                }
            }
            
            return announcements;
        }

        // 显示公告 - 移除根据公告类型改变颜色的逻辑
        function displayAnnouncements(announcements) {
            if (!announcements || announcements.length === 0) {
                document.getElementById('announcementBar').classList.add('hidden');
                return;
            }
            
            const announcementScroll = document.getElementById('announcementScroll');
            const announcementBar = document.getElementById('announcementBar');
            
            // 将所有公告连接起来，用分隔符隔开
            const allMessages = announcements.map(ann => ann.message).join('  |  ');
            announcementScroll.innerHTML = allMessages;
            
            // 保持为蓝色背景，不再根据类型改变颜色
            announcementBar.style.background = 'linear-gradient(90deg, #1a237e, #283593)';
            
            announcementBar.classList.remove('hidden');
            
            // 动态调整滚动速度（根据内容长度）
            const contentLength = allMessages.length;
            const duration = Math.max(30, contentLength / 3); // 每3个字符1秒，最少30秒
            announcementScroll.style.animationDuration = `${duration}s`;
        }

        function closeAnnouncement() {
            document.getElementById('announcementBar').classList.add('hidden');
        }

        // 初始化视频播放器
        function initializeVideoPlayer() {
            initializePlaylist();
            setupUserInteraction();
            playVideoFromPlaylist(currentPlaylistIndex);
        }

        // 初始化播放列表
        function initializePlaylist() {
            const playlistItems = document.getElementById('playlistItems');
            if (!playlistItems) return;
            
            playlistItems.innerHTML = VIDEO_PLAYLIST.map((video, index) => `
                <div class="playlist-item ${index === 0 ? 'active' : ''}" 
                     onclick="playVideoFromPlaylist(${index})">
                    ${index + 1}. ${video.title}
                </div>
            `).join('');
        }

        // 从播放列表播放视频
        function playVideoFromPlaylist(index) {
            currentPlaylistIndex = index;
            const video = VIDEO_PLAYLIST[index];
            
            document.querySelectorAll('.playlist-item').forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });
            
            const iframe = document.getElementById('bilibiliPlayer');
            
            showVideoLoading(true);
            hideVideoError();
            resetVideoProgress();
            
            if (video.type === 'bilibili') {
                let bilibiliUrl = `https://player.bilibili.com/player.html?bvid=${video.id}&page=1&high_quality=1&danmaku=0`;
                
                if (autoplayEnabled) {
                    bilibiliUrl += '&autoplay=1';
                }
                
                iframe.src = bilibiliUrl;
            } else if (video.type === 'direct') {
                iframe.src = video.id;
            }
            
            updateStatus(`正在播放: ${video.title}`, 'default');
            checkBilibiliPlayerLoad();
            setupVideoProgressDetection(video.duration || 300);
        }

        // 设置视频进度检测
        function setupVideoProgressDetection(videoDuration) {
            if (videoProgressInterval) {
                clearInterval(videoProgressInterval);
            }
            
            currentVideoStartTime = Date.now();
            const totalDuration = videoDuration;
            
            videoProgressInterval = setInterval(() => {
                const currentTime = Date.now();
                const elapsedSeconds = (currentTime - currentVideoStartTime) / 1000;
                const progressPercent = (elapsedSeconds / totalDuration) * 100;
                
                updateVideoProgress(progressPercent);
                
                if (progressPercent >= 100 && autoNextEnabled) {
                    clearInterval(videoProgressInterval);
                    playNextVideo();
                }
            }, 1000);
        }

        // 更新视频进度条
        function updateVideoProgress(percent) {
            const progressBar = document.getElementById('videoProgressBar');
            progressBar.style.width = Math.min(percent, 100) + '%';
        }

        // 重置视频进度
        function resetVideoProgress() {
            const progressBar = document.getElementById('videoProgressBar');
            progressBar.style.width = '0%';
        }

        // 播放下一个视频
        function playNextVideo() {
            currentPlaylistIndex = (currentPlaylistIndex + 1) % VIDEO_PLAYLIST.length;
            playVideoFromPlaylist(currentPlaylistIndex);
        }

        // 播放上一个视频
        function playPreviousVideo() {
            currentPlaylistIndex = (currentPlaylistIndex - 1 + VIDEO_PLAYLIST.length) % VIDEO_PLAYLIST.length;
            playVideoFromPlaylist(currentPlaylistIndex);
        }

        // 切换自动播放下一个视频
        function toggleAutoNext() {
            const btn = document.getElementById('autoNextBtn');
            autoNextEnabled = !autoNextEnabled;
            
            if (autoNextEnabled) {
                btn.textContent = '⏭️ 自动下一个: 开启';
                btn.classList.add('active');
                updateStatus('✅ 已开启自动播放下一个视频', 'success');
            } else {
                btn.textContent = '⏭️ 自动下一个: 关闭';
                btn.classList.remove('active');
                updateStatus('已关闭自动播放下一个视频', 'warning');
                
                if (videoProgressInterval) {
                    clearInterval(videoProgressInterval);
                    videoProgressInterval = null;
                }
            }
        }

        // 检测视频是否成功加载
        function checkBilibiliPlayerLoad() {
            const iframe = document.getElementById('bilibiliPlayer');
            
            iframe.onload = function() {
                showVideoLoading(false);
                updateStatus('✅ 视频加载成功', 'success');
                
                if (autoplayEnabled && userInteracted) {
                    setTimeout(forcePlay, 1000);
                }
            };
            
            iframe.onerror = function() {
                showVideoLoading(false);
                showVideoError();
                updateStatus('❌ 视频加载失败', 'error');
                
                if (videoProgressInterval) {
                    clearInterval(videoProgressInterval);
                    videoProgressInterval = null;
                }
            };
        }

        // 显示视频加载状态
        function showVideoLoading(show) {
            const loading = document.getElementById('videoLoading');
            loading.style.display = show ? 'flex' : 'none';
        }

        // 显示视频错误
        function showVideoError() {
            const error = document.getElementById('videoError');
            error.style.display = 'flex';
        }

        // 隐藏视频错误
        function hideVideoError() {
            const error = document.getElementById('videoError');
            error.style.display = 'none';
        }

        // 重试视频
        function retryVideo() {
            hideVideoError();
            playVideoFromPlaylist(currentPlaylistIndex);
        }

        // 重新加载视频
        function reloadBilibiliVideo() {
            const iframe = document.getElementById('bilibiliPlayer');
            const currentSrc = iframe.src;
            iframe.src = '';
            setTimeout(() => {
                iframe.src = currentSrc;
                updateStatus('重新加载视频...', 'default');
                checkBilibiliPlayerLoad();
            }, 100);
        }

        // 在新窗口打开视频
        function openInNewTab() {
            const iframe = document.getElementById('bilibiliPlayer');
            window.open(iframe.src, '_blank');
        }

        // 强制播放视频
        function forcePlay() {
            const iframe = document.getElementById('bilibiliPlayer');
            try {
                iframe.contentWindow.postMessage({
                    command: 'play'
                }, '*');
                
                updateStatus('尝试强制播放视频...', 'default');
            } catch (e) {
                console.error('强制播放失败:', e);
                updateStatus('❌ 强制播放失败（跨域限制）', 'error');
            }
        }

        // 切换自动播放
        function toggleAutoplay() {
            const btn = document.getElementById('autoplayBtn');
            autoplayEnabled = !autoplayEnabled;
            
            if (autoplayEnabled) {
                btn.textContent = '⏯️ 自动播放: 开启';
                btn.classList.add('active');
                updateStatus('✅ 已开启自动播放', 'success');
            } else {
                btn.textContent = '⏯️ 自动播放: 关闭';
                btn.classList.remove('active');
                updateStatus('已关闭自动播放', 'warning');
            }
            
            playVideoFromPlaylist(currentPlaylistIndex);
        }

        // 设置用户交互检测
        function setupUserInteraction() {
            document.addEventListener('click', function() {
                if (!userInteracted) {
                    userInteracted = true;
                    console.log("用户已与页面交互，尝试自动播放");
                    
                    if (autoplayEnabled) {
                        setTimeout(forcePlay, 500);
                    }
                }
            });
            
            document.addEventListener('keydown', function() {
                if (!userInteracted) {
                    userInteracted = true;
                    console.log("用户已与页面交互（键盘），尝试自动播放");
                    
                    if (autoplayEnabled) {
                        setTimeout(forcePlay, 500);
                    }
                }
            });
        }

        // 加载自定义视频
        function loadCustomVideo() {
            const videoUrl = document.getElementById('customVideoUrl').value.trim();
            
            if (!videoUrl) {
                alert('请输入视频URL');
                return;
            }
            
            VIDEO_PLAYLIST.push({
                id: videoUrl,
                title: '自定义视频',
                type: 'direct',
                duration: 300
            });
            
            initializePlaylist();
            playVideoFromPlaylist(VIDEO_PLAYLIST.length - 1);
            
            updateStatus('✅ 已添加自定义视频', 'success');
        }

        // 设置搜索类型
        function setSearchType(type) {
            currentSearchType = type;
            
            document.getElementById('imageSearchBtn').classList.toggle('active', type === 'image');
            document.getElementById('weightSearchBtn').classList.toggle('active', type === 'weight');
            
            const searchInput = document.getElementById('searchInput');
            if (type === 'image') {
                searchInput.placeholder = '输入图片代码、描述或标签进行搜索...';
            } else {
                searchInput.placeholder = '输入款式编码进行搜索...';
            }
            
            document.getElementById('results').innerHTML = `
                <div class="status-info">
                    <p>数据加载成功！</p>
                    <p>请选择搜索类型并输入关键词进行搜索</p>
                </div>
            `;
            document.getElementById('resultsInfo').innerHTML = '';
        }

        // 显示目录选择器
        function showDirectorySelector() {
            const directoryContainer = document.getElementById('directoryContainer');
            const directoryList = document.getElementById('directoryList');
            
            directoryList.innerHTML = DATA_DIRECTORIES.map((dir, index) => `
                <div class="directory-item" onclick="loadFromDirectory(${index})">
                    ${dir.name}
                </div>
            `).join('');
            
            directoryContainer.style.display = 'block';
            updateStatus('请选择数据源目录', 'default');
            
            return Promise.resolve();
        }

        // 从目录加载数据
        async function loadFromDirectory(index) {
            const directory = DATA_DIRECTORIES[index];
            currentDataSource = directory;
            
            document.querySelectorAll('.directory-item').forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });
            
            updateStatus(`正在从 ${directory.name} 加载数据...`, 'default');
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);
                
                const timestamp = Date.now();
                const dataUrl = directory.url.includes('?') 
                    ? `${directory.url}&t=${timestamp}` 
                    : `${directory.url}?t=${timestamp}`;
                
                const response = await fetch(dataUrl, {
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    const cloudData = await response.json();
                    imageData = cloudData;
                    
                    updateStatus(`✅ 已从 ${directory.name} 加载数据 (${imageData.length} 张图片)`, 'success');
                    updateDisplay(`✅ 使用 ${directory.name} 数据 (共 ${imageData.length} 张图片)`);
                } else {
                    throw new Error(`服务器返回 ${response.status} 错误`);
                }
            } catch (error) {
                console.error('数据加载失败:', error);
                
                if (error.name === 'AbortError') {
                    updateStatus(`⏰ ${directory.name} 加载超时，尝试备用方案`, 'warning');
                } else {
                    updateStatus(`❌ ${directory.name} 加载失败: ${error.message}`, 'error');
                }
                
                if (directory.url === "./images.json") {
                    updateStatus('正在尝试使用示例数据...', 'warning');
                    imageData = SAMPLE_DATA;
                    
                    updateStatus(`✅ 已使用示例数据 (${imageData.length} 张图片)`, 'success');
                    updateDisplay(`✅ 使用示例数据 (共 ${imageData.length} 张图片)`);
                }
            }
        }

        // 检查更新函数
        async function checkUpdate() {
            if (!currentDataSource) {
                alert('请先选择数据源');
                return;
            }
            
            try {
                updateStatus(`正在检查 ${currentDataSource.name} 更新...`, 'default');
                
                const timestamp = Date.now();
                const dataUrl = currentDataSource.url.includes('?') 
                    ? `${directory.url}&t=${timestamp}` 
                    : `${directory.url}?t=${timestamp}`;
                    
                const response = await fetch(dataUrl);
                
                if (response.ok) {
                    const cloudData = await response.json();
                    const currentCount = imageData.length;
                    const cloudCount = cloudData.length;
                    
                    if (cloudCount > currentCount) {
                        imageData = cloudData;
                        
                        const newImagesCount = cloudCount - currentCount;
                        updateStatus(`✅ ${currentDataSource.name} 已更新！新增 ${newImagesCount} 张图片`, 'success');
                        updateDisplay(`✅ 使用 ${currentDataSource.name} 数据 (共 ${cloudCount} 张图片，新增 ${newImagesCount} 张)`);
                    } else if (cloudCount === currentCount) {
                        updateStatus(`✅ ${currentDataSource.name} 已是最新数据`, 'success');
                    } else {
                        updateStatus(`⚠️ ${currentDataSource.name} 数据异常，数据量减少`, 'warning');
                    }
                } else {
                    throw new Error('服务器返回 ' + response.status + ' 错误');
                }
            } catch (error) {
                console.error('更新检查失败:', error);
                updateStatus(`⚠️ ${currentDataSource.name} 更新检查失败`, 'warning');
            }
        }

        // 更新状态显示
        function updateStatus(message, type = 'default') {
            const statusEl = document.getElementById('updateStatus');
            if (statusEl) {
                statusEl.innerHTML = '<span class="loading-spinner"></span>' + message;
                
                if (type === 'success') {
                    statusEl.style.background = 'rgba(46, 204, 113, 0.2)';
                    statusEl.style.borderLeftColor = '#2ecc71';
                } else if (type === 'warning') {
                    statusEl.style.background = 'rgba(243, 156, 18, 0.2)';
                    statusEl.style.borderLeftColor = '#f39c12';
                } else if (type === 'error') {
                    statusEl.style.background = 'rgba(231, 76, 60, 0.2)';
                    statusEl.style.borderLeftColor = '#e74c3c';
                } else {
                    statusEl.style.background = 'rgba(28, 37, 65, 0.8)';
                    statusEl.style.borderLeftColor = '#5bc0be';
                }
            }
        }

        // 更新显示
        function updateDisplay(message) {
            document.getElementById('resultsInfo').innerHTML = '<p>' + message + '</p>';
            document.getElementById('results').innerHTML = `
                <div class="status-info">
                    <p>数据加载成功！</p>
                    <p>请选择搜索类型并输入关键词进行搜索</p>
            </div>
            `;
        }

        // 搜索功能
        function search() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            if (!query) {
                document.getElementById('results').innerHTML = `
                    <div class="status-info">
                        <p>请输入搜索关键词</p>
                    </div>
                `;
                document.getElementById('resultsInfo').innerHTML = '';
                return;
            }
            
            if (currentSearchType === 'image') {
                searchImages(query);
            } else {
                searchWeights(query);
            }
            
            setTimeout(function() {
                scrollToResults();
            }, 150);
        }

        // 滚动到结果区域
        function scrollToResults() {
            const resultsContainer = document.getElementById('results');
            if (!resultsContainer) return;
            
            const containerRect = resultsContainer.getBoundingClientRect();
            const isMobile = window.innerWidth <= 768;
            const offset = isMobile ? 80 : 20;
            
            resultsContainer.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
            
            setTimeout(function() {
                const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
                const targetPosition = containerRect.top + window.pageYOffset - offset;
                
                if (Math.abs(currentScroll - targetPosition) > 50) {
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                }
            }, 300);
        }

        // ==================== 修改的关键函数 ====================
        
        // 搜索图片
        function searchImages(query) {
            if (!imageData || imageData.length === 0) {
                alert('请先选择数据源');
                return;
            }
            
            const results = imageData.filter(img => 
                img.code.toLowerCase().includes(query) || 
                (img.description && img.description.toLowerCase().includes(query)) ||
                (img.tags && img.tags.some(tag => tag.toLowerCase().includes(query)))
            );
            
            document.getElementById('resultsInfo').innerHTML = 
                `<p>找到 ${results.length} 个图片结果 (共 ${imageData.length} 张图片)</p>`;
                
            displayImages(results, query);
        }

        // 显示图片结果 - 移除操作指南，只显示图片
        function displayImages(images, query) {
            const resultsContainer = document.getElementById('results');
            
            if (images.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="status-info">
                        <p>没有找到与 "<strong>${query}</strong>" 匹配的图片</p>
                        <p>数据库中共有 ${imageData.length} 张图片</p>
                    </div>
                `;
                return;
            }
            
            resultsContainer.innerHTML = `
                <div class="image-results">
                    ${images.map(img => `
                        <div class="image-card" onclick="openImageModal('${img.url}', '${img.code}', '${img.description || ''}')">
                            <div class="image-wrapper">
                                <img src="${img.url}" alt="${img.code}" 
                                     id="img-${img.code}"
                                     onerror="handleImageError(this, '${img.code}')"
                                     loading="lazy"
                                     data-url="${img.url}"
                                     data-code="${img.code}">
                            </div>
                            <div class="image-info">
                                <div class="image-code">${img.code}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // 图片错误处理
        function handleImageError(imgElement, code) {
            console.log(`图片加载失败: ${code} - ${imgElement.src}`);
            imgElement.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWMyNTQxIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzViYzBiZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIEVycm9yPC90ZXh0Pjwvc3ZnPg==';
            imgElement.alt = '图片加载失败';
        }

        // 修改模态框，移除操作指南
        function openImageModal(imageUrl, code, description = '') {
    const modal = document.getElementById('imageModal');
    
    modal.innerHTML = `
        <button class="modal-close" onclick="closeModal()">×</button>
        <div class="modal-content">
            <div class="modal-image-container" style="padding: 0;">
                <img id="modalImage" src="${imageUrl}" alt="${code}" 
                     style="width: 100%; height: 100%; object-fit: contain; cursor: default;">
            </div>
        </div>
    `;
    
    modal.classList.add('active');
    document.addEventListener('keydown', handleModalKeydown);
}

        // 模态框键盘事件处理
        function handleModalKeydown(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        }

        // 关闭模态框
        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.classList.remove('active');
            document.removeEventListener('keydown', handleModalKeydown);
        }

        // 搜索重量
        function searchWeights(query) {
            const results = [];
            
            for (const [code, specs] of Object.entries(weightData)) {
                if (code.toLowerCase().includes(query)) {
                    results.push({ code, specs });
                }
            }
            
            document.getElementById('resultsInfo').innerHTML = 
                `<p>找到 ${results.length} 个重量结果 (共 ${Object.keys(weightData).length} 个款式)</p>`;
                
            displayWeights(results, query);
        }

        // 显示重量结果
        function displayWeights(results, query) {
            const resultsContainer = document.getElementById('results');
            
            if (results.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="status-info">
                        <p>没有找到与 "<strong>${query}</strong>" 匹配的重量数据</p>
                        <p>重量数据库中共有 ${Object.keys(weightData).length} 个款式</p>
                    </div>
                `;
                return;
            }
            
            resultsContainer.innerHTML = `
                <div class="weight-results">
                    ${results.map(item => {
                        const { code, specs } = item;
                        const weightList = Object.entries(specs).map(([spec, weight]) => 
                            `${spec}: ${weight}`
                        ).join('  ');
                        
                        return `
                        <div class="weight-card">
                            <div class="weight-header">
                                <span>${code}</span>
                                <button onclick="copyWeightData('${code}')" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid white; border-radius: 4px; padding: 6px 12px; cursor: pointer; font-size: 12px;">
                                    📋 复制整款
                                </button>
                            </div>
                            <div class="weight-content">
                                <div class="weight-specs">
                                    ${Object.entries(specs).map(([spec, weight]) => `
                                        <div class="weight-spec-item">
                                            <div class="weight-spec-name">${spec}</div>
                                            <div class="weight-spec-value">${weight}</div>
                                        </div>
                                    `).join('')}
                                </div>
                                <div style="margin-top: 10px; padding: 8px; background: rgba(91, 192, 190, 0.2); border-radius: 4px; font-size: 0.8rem; color: #7befff;">
                                    <strong>完整重量信息:</strong> ${weightList}
                                </div>
                                <button class="copy-all-btn" onclick="copyWeightData('${code}')">
                                    复制整款重量数据
                                </button>
                            </div>
                        </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        // 复制重量数据
        function copyWeightData(code) {
            const specs = weightData[code];
            if (!specs) return;
            
            const weightList = Object.entries(specs).map(([spec, weight]) => 
                `${spec}: ${weight}`
            ).join('  ');
            
            const textToCopy = `${code}克重 ${weightList}`;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                showCopyNotification(`✅ 已复制 ${code} 的重量数据`);
            }).catch(err => {
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showCopyNotification(`✅ 已复制 ${code} 的重量数据`);
            });
        }

        // 通用复制函数（用于复制文本）
        function copyToClipboard(text, type = '内容') {
            navigator.clipboard.writeText(text).then(() => {
                showCopyNotification(`✅ 已复制${type}: ${text.length > 30 ? text.substring(0, 30) + '...' : text}`);
            }).catch(err => {
                // 降级方案
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showCopyNotification(`✅ 已复制${type}: ${text.length > 30 ? text.substring(0, 30) + '...' : text}`);
            });
        }

        // 回车键搜索
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                search();
            }
        });

        // 页面加载时初始化
        initialize();
    </script>
</body>
</html>